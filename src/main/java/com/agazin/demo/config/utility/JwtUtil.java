package com.agazin.demo.config.utility;

import java.util.Map;

import org.springframework.security.jwt.Jwt;
import org.springframework.security.jwt.JwtHelper;
import org.springframework.security.oauth2.common.OAuth2AccessToken;

import com.fasterxml.jackson.databind.ObjectMapper;

/**
 * 
 * @author Fuangchai J
 *
 */

public class JwtUtil {

	public static String getSessionId(String token, String newSessionId) {
		// Jwt jwt =
		// JwtHelper.decode("eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOlsiZWZpbGluZyJdLCJ1c2VyX25hbWUiOiJmdWFuZ2NoYWlqIiwic2NvcGUiOlsicmVhZCIsIndyaXRlIl0sImF0aSI6ImZmNTk0NjNkLWY3YmQtNGExMC05OWY2LTc1Njc2YmNmNmFjMiIsInNlc3Npb25faWQiOiJBRDlCMUQ0QjhERjFCOEEwN0MyRUJERDUyMDhDRUQ1QyIsImV4cCI6MTU0NDQ1NzU0NCwiYWNjZXNzX2NoYW5uZWxfbmFtZSI6IuC4muC4uOC4hOC4hOC4peC4oOC4suC4ouC4meC4reC4gSIsImF1dGhvcml0aWVzIjpbIjEwMDAwMDEyMCIsIjEwMDAwMDAwMCIsIjEwMDAwMDEyMSIsIjEwMDAwMDAwMSIsIjEwMDAwMDEyMiIsIjEwMDAwMDAwMiIsIjEwMDAwMDEyMyIsIjEwMDAwMDAwMyIsIjEwMDAwMDEyNCIsIjEwMDAwMDAwNCIsIjEwMDAwMDEyNSIsIjEwMDAwMDAwNSIsIjEwMDAwMDEyNiIsIjEwMDAwMDAwNiIsIjEwMDAwMDEyNyIsIjEwMDAwMDAwNyIsIjEwMDAwMDEyOCIsIjEwMDAwMDAwOCIsIjEwMDAwMDEyOSIsIjEwMDAwMDAwOSIsIjEwMDAwMDExMCIsIjEwMDAwMDExMSIsIjEwMDAwMDExMiIsIjEwMDAwMDExMyIsIjEwMDAwMDExNCIsIjEwMDAwMDExNSIsIjEwMDAwMDExNiIsIjEwMDAwMDExNyIsIjEwMDAwMDExOCIsIjEwMDAwMDExOSIsIjEwMDAwMDE0MCIsIjEwMDAwMDAyMCIsIjEwMDAwMDE0MSIsIjEwMDAwMDAyMSIsIjEwMDAwMDE0MiIsIjEwMDAwMDAyMiIsIjEwMDAwMDE0MyIsIjEwMDAwMDAyMyIsIjEwMDAwMDE0NCIsIjEwMDAwMDAyNCIsIjEwMDAwMDE0NSIsIjEwMDAwMDAyNSIsIjEwMDAwMDE0NiIsIjEwMDAwMDAyNiIsIjEwMDAwMDE0NyIsIjEwMDAwMDAyNyIsIjEwMDAwMDE0OCIsIjEwMDAwMDAyOCIsIjEwMDAwMDE0OSIsIjEwMDAwMDAyOSIsIjEwMDAwMDEzMCIsIjEwMDAwMDAxMCIsIjEwMDAwMDEzMSIsIjEwMDAwMDAxMSIsIjEwMDAwMDEzMiIsIjEwMDAwMDAxMiIsIjEwMDAwMDEzMyIsIjEwMDAwMDAxMyIsIjEwMDAwMDEzNCIsIjEwMDAwMDAxNCIsIjEwMDAwMDEzNSIsIjEwMDAwMDAxNSIsIjEwMDAwMDEzNiIsIjEwMDAwMDAxNiIsIjEwMDAwMDEzNyIsIjEwMDAwMDAxNyIsIjEwMDAwMDEzOCIsIjEwMDAwMDAxOCIsIjEwMDAwMDEzOSIsIjEwMDAwMDAxOSIsIjEwMDAwMDE2MCIsIjEwMDAwMDA0MCIsIjEwMDAwMDE2MSIsIjEwMDAwMDA0MSIsIjEwMDAwMDE2MiIsIjEwMDAwMDA0MiIsIjEwMDAwMDE2MyIsIjEwMDAwMDA0MyIsIjEwMDAwMDE2NCIsIjEwMDAwMDA0NCIsIjEwMDAwMDE2NSIsIjEwMDAwMDA0NSIsIjEwMDAwMDE2NiIsIjEwMDAwMDA0NiIsIjEwMDAwMDE2NyIsIjEwMDAwMDA0NyIsIjEwMDAwMDE2OCIsIjEwMDAwMDA0OCIsIjEwMDAwMDE2OSIsIjEwMDAwMDA0OSIsIjEwMDAwMDE1MCIsIjEwMDAwMDAzMCIsIjEwMDAwMDE1MSIsIjEwMDAwMDAzMSIsIjEwMDAwMDE1MiIsIjEwMDAwMDAzMiIsIjEwMDAwMDE1MyIsIjEwMDAwMDAzMyIsIjEwMDAwMDE1NCIsIjEwMDAwMDAzNCIsIjEwMDAwMDE1NSIsIjEwMDAwMDAzNSIsIjEwMDAwMDE1NiIsIjEwMDAwMDAzNiIsIjEwMDAwMDE1NyIsIjEwMDAwMDAzNyIsIjEwMDAwMDE1OCIsIjEwMDAwMDAzOCIsIjEwMDAwMDE1OSIsIjEwMDAwMDAzOSIsIjEwMDAwMDE4MCIsIjEwMDAwMDA2MCIsIjEwMDAwMDE4MSIsIjEwMDAwMDA2MSIsIjEwMDAwMDE4MiIsIjEwMDAwMDA2MiIsIjEwMDAwMDE4MyIsIjEwMDAwMDA2MyIsIjEwMDAwMDE4NCIsIjEwMDAwMDA2NCIsIjEwMDAwMDE4NSIsIjEwMDAwMDA2NSIsIjEwMDAwMDE4NiIsIjEwMDAwMDA2NiIsIjEwMDAwMDE4NyIsIjEwMDAwMDA2NyIsIjEwMDAwMDE4OCIsIjEwMDAwMDA2OCIsIjEwMDAwMDE4OSIsIjEwMDAwMDA2OSIsIjEwMDAwMDE3MCIsIjEwMDAwMDA1MCIsIjEwMDAwMDE3MSIsIjEwMDAwMDA1MSIsIjEwMDAwMDE3MiIsIjEwMDAwMDA1MiIsIjEwMDAwMDE3MyIsIjEwMDAwMDA1MyIsIjEwMDAwMDE3NCIsIjEwMDAwMDA1NCIsIjEwMDAwMDE3NSIsIjEwMDAwMDA1NSIsIjEwMDAwMDE3NiIsIjEwMDAwMDA1NiIsIjEwMDAwMDE3NyIsIjEwMDAwMDA1NyIsIjEwMDAwMDE3OCIsIjEwMDAwMDA1OCIsIjEwMDAwMDE3OSIsIjEwMDAwMDA1OSIsIjEwMDAwMDA4MCIsIjEwMDAwMDA4MSIsIjEwMDAwMDA4MiIsIjEwMDAwMDA4MyIsIjEwMDAwMDA4NCIsIjEwMDAwMDA4NSIsIjEwMDAwMDA4NiIsIjEwMDAwMDA4NyIsIjEwMDAwMDA4OCIsIjEwMDAwMDA4OSIsIjExMTAxIiwiMTAwMDAwMTkwIiwiMTAwMDAwMDcwIiwiMTAwMDAwMTkxIiwiMTAwMDAwMDcxIiwiMTAwMDAwMTkyIiwiMTAwMDAwMDcyIiwiMTAwMDAwMTkzIiwiMTAwMDAwMDczIiwiMTAwMDAwMTk0IiwiMTAwMDAwMDc0IiwiMTAwMDAwMTk1IiwiMTAwMDAwMDc1IiwiMTAwMDAwMTk2IiwiMTAwMDAwMDc2IiwiMTAwMDAwMTk3IiwiMTAwMDAwMDc3IiwiMTAwMDAwMTk4IiwiMTAwMDAwMDc4IiwiMTAwMDAwMTk5IiwiMTAwMDAwMDc5IiwiMTAwMDAwMDkwIiwiMTAwMDAwMDkxIiwiMTAwMDAwMDkyIiwiMTAwMDAwMDkzIiwiMTAwMDAwMDk0IiwiMTAwMDAwMDk1IiwiMTAwMDAwMDk2IiwiMTAwMDAwMDk3IiwiMTAwMDAwMDk4IiwiMTAwMDAwMDk5IiwiMTEzMDEiLCIxMDAwMDAxMDAiLCIxMDAwMDAxMDEiLCIxMDAwMDAxMDIiLCIxMDAwMDAxMDMiLCIxMDAwMDAxMDQiLCIxMDAwMDAxMDUiLCIxMDAwMDAxMDYiLCIxMDAwMDAxMDciLCIxMDAwMDAxMDgiLCIxMDAwMDAxMDkiXSwianRpIjoiZmZlNGEyMjQtMGZlMy00ODg3LWFmOTgtOWRjYTZhZjliOWI1IiwiY2xpZW50X2lkIjoicmRzdGFmZndlYiIsImFjY2Vzc19jaGFubmVsX2NvZGUiOiJJTlQifQ.AMLPmCh-5aUTV5hTUzylTbjH5O5siUqQ3UZtB4xggow2Fsye3fpvDQPCep4Lkgbjs5ViKRNncIPlbkpHRceXddBFqjGRUgt-LCly2C66ohb5kCUppvwN_i-xJx6DJwROftgBhgiX-29g-OcyUdTfYdZ3_cs0nCcs1S9iWXgzYr-1KTVm3xN5z89kii3YNPMU0825FOPQZzvk3RPzD1e7CHhAZjtEPXkTaYFnHMKGRpxF2ARpMjjlQer8rcNzJzoKTCTNBKlTur1WKoGQEctjXB0QMc2zjR4xMOKvfeEbgGfkVlk1WU2wbL16YGTzOi0FhqJK83tlQtRyFxUdwMjlJA");
		String currentSessionId = newSessionId;
		try {
			Jwt jwt = JwtHelper.decode(token);
			OAuth2AccessToken oAuth2AccessToken = new ObjectMapper().readValue(jwt.getClaims().getBytes(),
					OAuth2AccessToken.class);
			currentSessionId = (String) oAuth2AccessToken.getAdditionalInformation().get("session_id");

			/*
			 * } catch (JsonParseException e) { e.printStackTrace(); } catch
			 * (JsonMappingException e) { e.printStackTrace(); } catch (IOException e) {
			 * e.printStackTrace();
			 */
		} catch (Exception e) {
			// Ignore
			e.printStackTrace();
		}

		return currentSessionId;
	}

	public static OAuth2AccessToken getOAuth2AccessToken(String token) {
		// Jwt jwt =
		// JwtHelper.decode("eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOlsiZWZpbGluZyJdLCJ1c2VyX25hbWUiOiJmdWFuZ2NoYWlqIiwic2NvcGUiOlsicmVhZCIsIndyaXRlIl0sImF0aSI6ImZmNTk0NjNkLWY3YmQtNGExMC05OWY2LTc1Njc2YmNmNmFjMiIsInNlc3Npb25faWQiOiJBRDlCMUQ0QjhERjFCOEEwN0MyRUJERDUyMDhDRUQ1QyIsImV4cCI6MTU0NDQ1NzU0NCwiYWNjZXNzX2NoYW5uZWxfbmFtZSI6IuC4muC4uOC4hOC4hOC4peC4oOC4suC4ouC4meC4reC4gSIsImF1dGhvcml0aWVzIjpbIjEwMDAwMDEyMCIsIjEwMDAwMDAwMCIsIjEwMDAwMDEyMSIsIjEwMDAwMDAwMSIsIjEwMDAwMDEyMiIsIjEwMDAwMDAwMiIsIjEwMDAwMDEyMyIsIjEwMDAwMDAwMyIsIjEwMDAwMDEyNCIsIjEwMDAwMDAwNCIsIjEwMDAwMDEyNSIsIjEwMDAwMDAwNSIsIjEwMDAwMDEyNiIsIjEwMDAwMDAwNiIsIjEwMDAwMDEyNyIsIjEwMDAwMDAwNyIsIjEwMDAwMDEyOCIsIjEwMDAwMDAwOCIsIjEwMDAwMDEyOSIsIjEwMDAwMDAwOSIsIjEwMDAwMDExMCIsIjEwMDAwMDExMSIsIjEwMDAwMDExMiIsIjEwMDAwMDExMyIsIjEwMDAwMDExNCIsIjEwMDAwMDExNSIsIjEwMDAwMDExNiIsIjEwMDAwMDExNyIsIjEwMDAwMDExOCIsIjEwMDAwMDExOSIsIjEwMDAwMDE0MCIsIjEwMDAwMDAyMCIsIjEwMDAwMDE0MSIsIjEwMDAwMDAyMSIsIjEwMDAwMDE0MiIsIjEwMDAwMDAyMiIsIjEwMDAwMDE0MyIsIjEwMDAwMDAyMyIsIjEwMDAwMDE0NCIsIjEwMDAwMDAyNCIsIjEwMDAwMDE0NSIsIjEwMDAwMDAyNSIsIjEwMDAwMDE0NiIsIjEwMDAwMDAyNiIsIjEwMDAwMDE0NyIsIjEwMDAwMDAyNyIsIjEwMDAwMDE0OCIsIjEwMDAwMDAyOCIsIjEwMDAwMDE0OSIsIjEwMDAwMDAyOSIsIjEwMDAwMDEzMCIsIjEwMDAwMDAxMCIsIjEwMDAwMDEzMSIsIjEwMDAwMDAxMSIsIjEwMDAwMDEzMiIsIjEwMDAwMDAxMiIsIjEwMDAwMDEzMyIsIjEwMDAwMDAxMyIsIjEwMDAwMDEzNCIsIjEwMDAwMDAxNCIsIjEwMDAwMDEzNSIsIjEwMDAwMDAxNSIsIjEwMDAwMDEzNiIsIjEwMDAwMDAxNiIsIjEwMDAwMDEzNyIsIjEwMDAwMDAxNyIsIjEwMDAwMDEzOCIsIjEwMDAwMDAxOCIsIjEwMDAwMDEzOSIsIjEwMDAwMDAxOSIsIjEwMDAwMDE2MCIsIjEwMDAwMDA0MCIsIjEwMDAwMDE2MSIsIjEwMDAwMDA0MSIsIjEwMDAwMDE2MiIsIjEwMDAwMDA0MiIsIjEwMDAwMDE2MyIsIjEwMDAwMDA0MyIsIjEwMDAwMDE2NCIsIjEwMDAwMDA0NCIsIjEwMDAwMDE2NSIsIjEwMDAwMDA0NSIsIjEwMDAwMDE2NiIsIjEwMDAwMDA0NiIsIjEwMDAwMDE2NyIsIjEwMDAwMDA0NyIsIjEwMDAwMDE2OCIsIjEwMDAwMDA0OCIsIjEwMDAwMDE2OSIsIjEwMDAwMDA0OSIsIjEwMDAwMDE1MCIsIjEwMDAwMDAzMCIsIjEwMDAwMDE1MSIsIjEwMDAwMDAzMSIsIjEwMDAwMDE1MiIsIjEwMDAwMDAzMiIsIjEwMDAwMDE1MyIsIjEwMDAwMDAzMyIsIjEwMDAwMDE1NCIsIjEwMDAwMDAzNCIsIjEwMDAwMDE1NSIsIjEwMDAwMDAzNSIsIjEwMDAwMDE1NiIsIjEwMDAwMDAzNiIsIjEwMDAwMDE1NyIsIjEwMDAwMDAzNyIsIjEwMDAwMDE1OCIsIjEwMDAwMDAzOCIsIjEwMDAwMDE1OSIsIjEwMDAwMDAzOSIsIjEwMDAwMDE4MCIsIjEwMDAwMDA2MCIsIjEwMDAwMDE4MSIsIjEwMDAwMDA2MSIsIjEwMDAwMDE4MiIsIjEwMDAwMDA2MiIsIjEwMDAwMDE4MyIsIjEwMDAwMDA2MyIsIjEwMDAwMDE4NCIsIjEwMDAwMDA2NCIsIjEwMDAwMDE4NSIsIjEwMDAwMDA2NSIsIjEwMDAwMDE4NiIsIjEwMDAwMDA2NiIsIjEwMDAwMDE4NyIsIjEwMDAwMDA2NyIsIjEwMDAwMDE4OCIsIjEwMDAwMDA2OCIsIjEwMDAwMDE4OSIsIjEwMDAwMDA2OSIsIjEwMDAwMDE3MCIsIjEwMDAwMDA1MCIsIjEwMDAwMDE3MSIsIjEwMDAwMDA1MSIsIjEwMDAwMDE3MiIsIjEwMDAwMDA1MiIsIjEwMDAwMDE3MyIsIjEwMDAwMDA1MyIsIjEwMDAwMDE3NCIsIjEwMDAwMDA1NCIsIjEwMDAwMDE3NSIsIjEwMDAwMDA1NSIsIjEwMDAwMDE3NiIsIjEwMDAwMDA1NiIsIjEwMDAwMDE3NyIsIjEwMDAwMDA1NyIsIjEwMDAwMDE3OCIsIjEwMDAwMDA1OCIsIjEwMDAwMDE3OSIsIjEwMDAwMDA1OSIsIjEwMDAwMDA4MCIsIjEwMDAwMDA4MSIsIjEwMDAwMDA4MiIsIjEwMDAwMDA4MyIsIjEwMDAwMDA4NCIsIjEwMDAwMDA4NSIsIjEwMDAwMDA4NiIsIjEwMDAwMDA4NyIsIjEwMDAwMDA4OCIsIjEwMDAwMDA4OSIsIjExMTAxIiwiMTAwMDAwMTkwIiwiMTAwMDAwMDcwIiwiMTAwMDAwMTkxIiwiMTAwMDAwMDcxIiwiMTAwMDAwMTkyIiwiMTAwMDAwMDcyIiwiMTAwMDAwMTkzIiwiMTAwMDAwMDczIiwiMTAwMDAwMTk0IiwiMTAwMDAwMDc0IiwiMTAwMDAwMTk1IiwiMTAwMDAwMDc1IiwiMTAwMDAwMTk2IiwiMTAwMDAwMDc2IiwiMTAwMDAwMTk3IiwiMTAwMDAwMDc3IiwiMTAwMDAwMTk4IiwiMTAwMDAwMDc4IiwiMTAwMDAwMTk5IiwiMTAwMDAwMDc5IiwiMTAwMDAwMDkwIiwiMTAwMDAwMDkxIiwiMTAwMDAwMDkyIiwiMTAwMDAwMDkzIiwiMTAwMDAwMDk0IiwiMTAwMDAwMDk1IiwiMTAwMDAwMDk2IiwiMTAwMDAwMDk3IiwiMTAwMDAwMDk4IiwiMTAwMDAwMDk5IiwiMTEzMDEiLCIxMDAwMDAxMDAiLCIxMDAwMDAxMDEiLCIxMDAwMDAxMDIiLCIxMDAwMDAxMDMiLCIxMDAwMDAxMDQiLCIxMDAwMDAxMDUiLCIxMDAwMDAxMDYiLCIxMDAwMDAxMDciLCIxMDAwMDAxMDgiLCIxMDAwMDAxMDkiXSwianRpIjoiZmZlNGEyMjQtMGZlMy00ODg3LWFmOTgtOWRjYTZhZjliOWI1IiwiY2xpZW50X2lkIjoicmRzdGFmZndlYiIsImFjY2Vzc19jaGFubmVsX2NvZGUiOiJJTlQifQ.AMLPmCh-5aUTV5hTUzylTbjH5O5siUqQ3UZtB4xggow2Fsye3fpvDQPCep4Lkgbjs5ViKRNncIPlbkpHRceXddBFqjGRUgt-LCly2C66ohb5kCUppvwN_i-xJx6DJwROftgBhgiX-29g-OcyUdTfYdZ3_cs0nCcs1S9iWXgzYr-1KTVm3xN5z89kii3YNPMU0825FOPQZzvk3RPzD1e7CHhAZjtEPXkTaYFnHMKGRpxF2ARpMjjlQer8rcNzJzoKTCTNBKlTur1WKoGQEctjXB0QMc2zjR4xMOKvfeEbgGfkVlk1WU2wbL16YGTzOi0FhqJK83tlQtRyFxUdwMjlJA");
		OAuth2AccessToken oAuth2AccessToken = null;
		try {
			Jwt jwt = JwtHelper.decode(token);
			oAuth2AccessToken = new ObjectMapper().readValue(jwt.getClaims().getBytes(), OAuth2AccessToken.class);
		} catch (Exception e) {
			// Ignore
			e.printStackTrace();
		}

		return oAuth2AccessToken;
	}
	
//	public static void main(String[] args) {
//		convertAccessToken("eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjEsImF1ZCI6WyJlZmlsaW5nIl0sInVzZXJfbmFtZSI6ImZ1YW5nY2hhaWoiLCJzY29wZSI6WyJyZWFkIiwid3JpdGUiXSwic2Vzc2lvbl9pZCI6IjhBRTZBRTRFNTMzMjZCMEFGMDM2MzQwOEUyQjEzQjkzIiwiZXhwIjoxNTQ1MTQ5NjA4LCJhY2Nlc3NfY2hhbm5lbF9uYW1lIjoi4Lia4Li44LiE4LiE4Lil4Lig4Liy4Lii4LiZ4Lit4LiBIiwiYXV0aG9yaXRpZXMiOlsiMTAxMDEwMDAxIiwiMTAyMDEwMTA1IiwiMTAxMDEwMDAyIiwiMTAyMDEwMTA2IiwiMTAyMDEwMTAzIiwiMTAyMDEwMTA0IiwiMTAxMDMwMDAxIiwiMTAxMDQwMDAyIiwiMTAyMDEwMTA3IiwiMTAxMDQwMDAxIiwiMTAyMDEwMTAxIiwiMTAyMDEwMTAyIiwiMTAxMDUwMDAxIiwiMTAxMDIwMDAxIl0sImp0aSI6IjdiM2E5NWU0LTM4MTUtNGNiOC1hZmQxLTY0MzdiNmU4MDk0YiIsImNsaWVudF9pZCI6InJkc3RhZmZ3ZWIiLCJhY2Nlc3NfY2hhbm5lbF9jb2RlIjoiSU5UIn0.dQUP1ZQBFVvP6hWqveGfI5cprYDBvw_zxJJBBuhOMEcat5u2AFW2z1hmcl4yM7RGKfBD1sp-NBNpkiaItIuWwnrKkaOA1kZZMgM95Dr1Beut0tutimcPhhqi0xdNeFbUSBPBNBSyNcCIQ3HzPHIMwBxCw59TRB8UyAGbu1aUsRkDjyqxuAZg3bj13pZ2-NHQmqOUpMWvySplCXM4zblTcXhzVHXy3EgwqKy4wm8ga7qs49Y4BoU5FJwc2PdrxBLuoqzRGifqiciycQ9nvoLTSte47kn1ZZm525_xBBvuNRc91L5w452r67jwdWGIWDi0NUZYwcuA_QhGPjOSLKtcuQ");
//	}
	
	public static Map<String,Object> convertAccessToken(String token) {
		Map<String, Object> map = null;
		try {
			Jwt jwt = JwtHelper.decode(token);
			map = new ObjectMapper().readValue(jwt.getClaims().getBytes(), Map.class);

		} catch (Exception e) {
			// Ignore
			e.printStackTrace();
		}

		return map;
	}
}
